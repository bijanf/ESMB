#######################################################################################
### conda added to PATH. Use 'source activate' rather than 'conda activate'.        ###
### Do not run 'conda init' if prompted.                                            ###
### 'conda init' will modify your shell outside of the `module` environment         ###
#######################################################################################
W0119 17:17:19.768798 2967354 cuda_executor.cc:1802] GPU interconnect information not available: INTERNAL: NVML doesn't support extracting fabric info or NVLink is not used by the device.
W0119 17:17:19.773590 2967309 cuda_executor.cc:1802] GPU interconnect information not available: INTERNAL: NVML doesn't support extracting fabric info or NVLink is not used by the device.
Traceback (most recent call last):
  File "/home/fallah/scripts/ESMB/experiments/production_control.py", line 323, in <module>
    run_control(years=100.0)
  File "/home/fallah/scripts/ESMB/experiments/production_control.py", line 251, in run_control
    current_state, accumulated = run_one_month(current_state)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fallah/scripts/ESMB/experiments/production_control.py", line 212, in run_one_month
    (final_s, final_acc), _ = jax.lax.scan(
                              ^^^^^^^^^^^^^
  File "/home/fallah/scripts/ESMB/experiments/production_control.py", line 189, in month_step_fn
    new_s = main.step_coupled(
            ^^^^^^^^^^^^^^^^^^
  File "/home/fallah/scripts/ESMB/chronos_esm/main.py", line 403, in step_coupled
    new_ocean = ocean_driver.step_ocean(
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fallah/scripts/ESMB/chronos_esm/ocean/veros_driver.py", line 660, in step_ocean
    temp_new = compute_shapiro_filter(temp_new, strength=shapiro_strength if shapiro_strength > 0 else 0.05)
                                                                             ^^^^^^^^^^^^^^^^^^^^
jax.errors.TracerBoolConversionError: Attempted boolean conversion of traced array with shape bool[].
The error occurred while tracing the function step_ocean at /home/fallah/scripts/ESMB/chronos_esm/ocean/veros_driver.py:48 for jit. This concrete value was not available in Python because it depends on the value of the argument shapiro_strength.
See https://docs.jax.dev/en/latest/errors.html#jax.errors.TracerBoolConversionError
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
